CWE_532_RULE = """
[CWE-532 Reference Guideline | Insertion of Sensitive Information into Log File | Non-binding, Evidence-first]

Overview
- CWE-532 occurs when a product logs sensitive information (e.g., passwords, personal data, cryptographic keys) into log files, where it may be accessed by unauthorized actors.
- Sensitive information should never be written to logs, as logs are often accessible to various components, system administrators, or external attackers. Exposing sensitive data in logs can lead to security breaches, unauthorized access, or data leakage.
- In partial snippets, missing log sanitization or inappropriate logging practices are not proof of vulnerability. Use this guideline to form hypotheses and identify code evidence that would confirm or refute them.

What counts as “sensitive information” (static analysis framing)
- Personal Identifiable Information (PII):
  - Names, addresses, phone numbers, social security numbers, email addresses.
- Authentication and session data:
  - Passwords, password hashes, API keys, session tokens, login credentials.
- Financial or sensitive business data:
  - Credit card numbers, banking details, transaction data.
- Cryptographic information:
  - Private keys, encryption keys, IVs, nonces.
- Internal system information:
  - Debugging data, configuration details that should not be exposed to unauthorized users (e.g., database connection strings, server paths).

Where sensitive information should not be logged (sensitive sinks)
- Authentication or session management:
  - Login attempts, session creation data, failed login messages, session IDs.
- Sensitive transactions:
  - Payment processing, transaction IDs, personally identifiable transaction data.
- System or configuration details:
  - File paths, internal server addresses, API tokens, or other sensitive service configuration.
- Error or exception handling:
  - Stack traces, error messages, or internal exceptions that include sensitive data.

Common failure modes (reasoning hints, not assumptions)
- Sensitive information is logged without sanitization:
  - Logging functions include sensitive data like passwords, authentication tokens, or personal information without obfuscation or exclusion.
- Unrestricted logging in error handling:
  - Detailed error messages or exceptions are logged, potentially exposing sensitive internal data (e.g., database errors containing connection strings, stack traces with sensitive method arguments).
- Debugging information left in logs:
  - Logging debug-level information that includes sensitive details, even if not essential for error tracing.
- Lack of logging configuration:
  - Logging policies or filters are not in place to exclude sensitive data from logs.
  
What “proper logging and sanitization” looks like (context-specific)
- Exclude sensitive information from logs:
  - Implement filters or policies to ensure sensitive data (e.g., passwords, API keys, PII) is never written to log files.
- Mask or obfuscate sensitive information:
  - Mask or redact sensitive data before logging it (e.g., logging only the last 4 digits of a credit card number or a session token).
- Use secure logging libraries:
  - Utilize secure logging libraries that automatically prevent the logging of sensitive information, or provide easy configurations for masking.
- Implement strict logging levels:
  - Use appropriate logging levels (e.g., error, warning, info) and avoid logging debug-level information in production environments, especially if sensitive data is involved.
- Log sensitive data only for authorized users:
  - Ensure that logs are restricted to authorized users and protected by access controls to prevent unauthorized access.

Common weak/insufficient defenses (signals of possible risk)
- Logging sensitive data without filtering or masking:
  - Passwords, tokens, personal information, or other sensitive details are logged in plain text.
- Excessive or unnecessary logging of sensitive information:
  - Debugging information or error messages with sensitive data are logged without justification or appropriate sanitization.
- No logging configuration or access control:
  - Logs are accessible to unauthorized users or stored without access restrictions, exposing sensitive data.
- Insufficient logging policy enforcement:
  - Lack of global logging policies to sanitize or exclude sensitive information.

Evidence to look for in code (static snippet oriented)
- Strong evidence of mitigation:
  - Logs that exclude sensitive information, either by masking, redacting, or never logging it in the first place.
  - Use of secure logging libraries or frameworks that prevent the logging of sensitive data by default.
  - Logging configurations that specify which types of information should be logged (e.g., avoid logging sensitive data or include it in a sanitized form).
  - Access controls and permissions in place to ensure logs are only accessible to authorized users.
- Evidence suggesting vulnerability:
  - Sensitive data (e.g., passwords, tokens, personal information) logged in clear text without masking or sanitization.
  - Error handling logs that include sensitive details, such as stack traces with internal configuration or authentication data.
  - No evidence of filtering or excluding sensitive data from logs.

How to use this guideline under incomplete context
- Identify logging points and inputs:
  - What data is being logged and where? Are sensitive fields such as passwords, tokens, or PII included in the logs?
- Identify logging configurations:
  - Are there any checks or configurations in place to sanitize or redact sensitive data before logging it?
- Generate a small number of targeted hypotheses:
  - H1: Sensitive data is logged directly without any validation or sanitization (e.g., passwords, tokens).
  - H2: Logs contain error messages or stack traces that expose sensitive system details.
  - H3: Logging is properly configured to prevent sensitive data from being written to logs but is not visible in the snippet.
  - H4: Logs are accessible without sufficient access control or encryption, exposing sensitive data to unauthorized actors.
- For each hypothesis, specify:
  (a) evidence in the snippet supporting it (sensitive fields being logged, error messages, unprotected access),
  (b) evidence needed to confirm it (logging configurations, filtering mechanisms, access control checks),
  (c) counter-evidence that would refute it (secure logging practices, explicit data sanitization).

Quick red flags in partial code (weak → strong)
- Strong: Sensitive data (passwords, tokens, PII) is logged in clear text without filtering or masking.
- Medium: Debugging or error messages contain sensitive information, such as stack traces or internal configuration data.
- Medium: Logs are written without any indication of input sanitization or masking for sensitive data.
- Weak: Log sanitization may be handled outside of the shown code (in global handlers or external libraries) → treat as Unknown and reduce confidence.
"""
if __name__ == "__main__":
    print(CWE_532_RULE)