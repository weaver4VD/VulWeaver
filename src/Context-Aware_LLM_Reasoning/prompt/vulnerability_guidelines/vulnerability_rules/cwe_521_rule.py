CWE_521_RULE = """
[CWE-521 Reference Guideline | Weak Password Requirements | Non-binding, Evidence-first]

Overview
- CWE-521 occurs when a product does not enforce strong password policies, allowing users to set weak passwords that can be easily guessed or cracked.
- Weak passwords can lead to unauthorized access, especially if attackers use brute-force or dictionary-based attacks. This can compromise user accounts and potentially lead to security breaches, data theft, or system takeover.
- In partial snippets, missing password policy enforcement evidence is not proof of vulnerability. Use this guideline to form hypotheses and identify code evidence that would confirm or refute them.

What counts as “strong password requirements” (static analysis framing)
- Length requirements:
  - Passwords should be of a minimum length (e.g., at least 8–12 characters).
- Complexity requirements:
  - Passwords should include a mix of uppercase letters, lowercase letters, numbers, and special characters.
- Unpredictability:
  - Passwords should not contain easily guessable patterns, common words, or predictable sequences.
- Avoiding reuse:
  - Passwords should not be reused across different accounts, and users should be encouraged to create unique passwords.
- Blacklist of weak passwords:
  - Common passwords (e.g., "123456", "password", "qwerty") should be disallowed.

Where weak password requirements typically arise (sensitive sinks)
- Account creation or password change endpoints:
  - User registration or password reset forms that do not enforce strong password rules.
- Authentication endpoints:
  - Login functions that accept weak passwords or do not account for failed login attempts, making brute-force attacks easier.
- Password validation checks:
  - Functions that check password strength or enforce password policies during account setup or password change.

Common failure modes (reasoning hints, not assumptions)
- No minimum length enforcement:
  - Accepting passwords that are too short to be secure (e.g., passwords shorter than 6–8 characters).
- Lack of character variety:
  - Allowing passwords that consist only of lowercase letters or simple sequences (e.g., "abc123").
- Predictable patterns allowed:
  - Allowing passwords with easily guessable patterns, such as "password1" or "qwerty".
- No password strength feedback:
  - Not providing feedback to users about password strength (e.g., weak/strong password warnings).
- No prevention of common passwords:
  - Accepting common, easily guessable passwords like "123456" or "password".
  
What “strong password requirements” look like (context-specific)
- Enforce minimum password length:
  - Require passwords to be at least 8–12 characters long.
- Enforce complexity rules:
  - Require a mix of characters (upper/lowercase letters, digits, special characters).
- Educate users about strong passwords:
  - Provide guidance or warnings when users create weak passwords and recommend using passphrases or password managers.
- Blacklist weak passwords:
  - Disallow commonly known passwords or sequences (e.g., "123456", "password", "qwerty") during account creation and password changes.
- Implement rate limiting and account lockout:
  - Protect against brute-force attacks by limiting the number of failed login attempts and locking accounts after a certain threshold.
  
Common weak/insufficient defenses (signals of possible risk)
- No password length or complexity enforcement:
  - Accepting passwords that are short or lack diversity (e.g., no uppercase letters, no special characters).
- No feedback or checks for password strength:
  - Allowing weak passwords without informing the user or providing strength feedback.
- Allowing common passwords:
  - Users can set simple, well-known passwords (e.g., "password", "123456").
- No brute-force protection:
  - Failing to protect against brute-force or dictionary attacks with mechanisms like rate-limiting or account lockouts.
  
Evidence to look for in code (static snippet oriented)
- Strong evidence of mitigation:
  - Code that enforces a minimum password length and complexity (e.g., requiring a mix of uppercase, lowercase, digits, and special characters).
  - Password strength feedback is provided, helping users choose stronger passwords.
  - Common passwords are checked against a blacklist (e.g., disallowing "password", "123456").
  - Account lockout or rate-limiting mechanisms to protect against brute-force attacks.
- Evidence suggesting vulnerability:
  - Passwords can be set without any length or complexity checks (e.g., passwords with only lowercase letters or less than 6 characters).
  - No feedback is provided on password strength, allowing users to create weak passwords.
  - No blacklist or restrictions on easily guessable passwords.
  - No rate-limiting or account lockout mechanisms in place for login attempts.
  
How to use this guideline under incomplete context
- Identify password-related functions:
  - Where are passwords validated or enforced? Are there checks for minimum length or complexity?
- Identify where password policies are enforced:
  - Are there rules for password strength, or can users create easily guessable passwords?
- Generate a small number of targeted hypotheses:
  - H1: Passwords are allowed to be weak (short or lacking complexity).
  - H2: No password feedback or strength guidelines are provided to the user.
  - H3: Common or weak passwords are allowed (e.g., "password1").
  - H4: There are no mechanisms to prevent brute-force attacks (e.g., rate-limiting or lockout).
- For each hypothesis, specify:
  (a) evidence in the snippet supporting it (password validation functions, password feedback, login mechanisms),
  (b) evidence needed to confirm it (password policy configuration, feedback logic, brute-force defense checks),
  (c) counter-evidence that would refute it (strong password validation rules, feedback, brute-force protection).

Quick red flags in partial code (weak → strong)
- Strong: No password validation or complexity checks, allowing weak passwords.
- Medium: Passwords are accepted with minimal checks (e.g., only requiring a length greater than 4 characters).
- Medium: No feedback or strength requirements for passwords during account creation or password changes.
- Weak: Password validation may be handled by external libraries or frameworks not shown → treat as Unknown and reduce confidence.
"""
if __name__ == "__main__":
    print(CWE_521_RULE)