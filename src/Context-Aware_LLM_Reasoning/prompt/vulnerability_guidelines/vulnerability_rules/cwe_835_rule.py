CWE_835_RULE = """
[CWE-835 Reference Guideline | Loop with Unreachable Exit Condition ('Infinite Loop') | Non-binding, Evidence-first]

Overview
- CWE-835 occurs when a product contains an iteration or loop with an exit condition that cannot be reached, resulting in an infinite loop.
- An infinite loop causes the program to become unresponsive, consume system resources unnecessarily, and potentially lead to crashes or denial of service (DoS). It may also open the door for further exploits in certain scenarios, especially when system resources are exhausted.
- In partial snippets, missing or incorrectly configured loop exit conditions are not proof of vulnerability. Use this guideline to form hypotheses and identify code evidence that would confirm or refute them.

What counts as “unreachable exit condition” and “infinite loop” (static analysis framing)
- Unreachable exit condition:
  - A condition in a loop (e.g., `while`, `for`, or `do-while`) that cannot logically be met or triggered, causing the loop to run indefinitely.
  - This could happen due to improper condition checks, incorrect logical operators, or variables that never change within the loop.
- Infinite loop:
  - A loop that continues to execute without terminating, either due to an unreachable exit condition or a lack of proper updates to the variables controlling the loop’s termination.

Where infinite loop issues typically occur (sensitive sinks)
- Improper loop conditions:
  - A `while` loop with a condition that is always true (e.g., `while (true)` without any break or exit condition).
- Incorrect termination conditions:
  - A `for` loop with incorrect iteration boundaries or conditions that never allow the loop to exit (e.g., using a counter variable that is not updated or incremented properly).
- Misconfigured exit statements:
  - Missing or misplaced `break` or `return` statements that prevent the loop from terminating as intended.
- Insufficient loop condition updates:
  - A loop where the variable(s) controlling the exit condition are not updated within the loop body, leading to the loop running indefinitely.

Common failure modes (reasoning hints, not assumptions)
- Incorrect condition logic:
  - Loop conditions that are logically flawed, such as using `==` where `!=` should be, or having conditions that are always true.
- Variable not updated:
  - Loop variables that are never modified or incremented within the loop, preventing the exit condition from being met.
- Missing `break` or `return` statements:
  - The absence of appropriate exit statements (`break`, `return`, or `exit`) in the loop causes the iteration to run infinitely.
- Incorrect loop counter or iterator:
  - In `for` loops, misconfigured loop counters or iterators that prevent the loop from reaching its exit condition.

What “proper loop termination” looks like (context-specific)
- Ensure loop conditions are correctly defined:
  - The loop exit condition should be logically sound and achievable based on the state of variables controlling the loop.
- Update loop variables within the body:
  - Ensure that any variables used to control the loop (e.g., counters, flags) are updated correctly in every iteration.
- Use proper loop boundaries:
  - Ensure `for` and `while` loops have correctly defined limits and conditions that guarantee the loop will terminate at some point.
- Incorporate explicit exit mechanisms:
  - Use `break` or `return` statements to exit loops when certain conditions are met, preventing infinite iterations.
- Ensure loop termination in all cases:
  - Even in exceptional or error conditions, ensure that the loop terminates properly, preventing it from becoming unresponsive.

Common weak/insufficient defenses (signals of possible risk)
- Loop conditions that are always true:
  - Using conditions like `while (true)` without any internal mechanism to break or exit the loop.
- Failure to update loop control variables:
  - Variables controlling the loop's exit condition are not updated within the loop, leading to infinite iterations.
- Missing exit or return statements:
  - The loop continues to run indefinitely because `break`, `return`, or similar statements are missing or not used in the proper place.
- Ineffective use of loop counters:
  - Loop counters or iterators that are incorrectly incremented, not initialized, or are subject to flawed logic that prevents them from terminating the loop.

Evidence to look for in code (static snippet oriented)
- Strong evidence of mitigation:
  - Loop conditions are logically sound and achievable, ensuring that the exit condition can be met under normal circumstances.
  - Loop variables are properly updated within the body of the loop (e.g., incrementing counters, modifying flags).
  - Explicit exit mechanisms (`break`, `return`) are used when certain conditions are met within the loop.
  - Properly configured `for` loop counters or `while` loop conditions that ensure the loop will terminate.
- Evidence suggesting vulnerability:
  - A `while (true)` loop with no clear exit condition or `break` statement.
  - Loop variables (e.g., counters, flags) are not updated or modified within the loop body, leading to a non-terminating loop.
  - The loop's exit condition is logically impossible to achieve (e.g., `while (x < 10 && x > 15)`).
  - Missing or incorrectly placed `break`, `return`, or other exit statements within the loop, causing it to run indefinitely.

How to use this guideline under incomplete context
- Identify the loop and its conditions:
  - What is the exit condition for the loop? Is it logically possible for the loop to exit, or is it stuck in an infinite state?
- Identify loop variables:
  - Are the variables controlling the loop's termination being properly updated within the loop body? If not, what could be causing them to remain unchanged?
- Generate a small number of targeted hypotheses:
  - H1: The loop's exit condition is unreachable due to incorrect logical operators or conditions that never evaluate to true.
  - H2: The loop variable(s) are not updated inside the loop, leading to infinite iterations.
  - H3: The loop has a valid condition but lacks an exit mechanism, such as a `break` statement or a return condition.
  - H4: Loop conditions or variables are handled outside the snippet (e.g., in external functions or global variables), making them hard to verify.
- For each hypothesis, specify:
  (a) evidence in the snippet supporting it (e.g., `while (true)` loops, unmodified variables),
  (b) evidence needed to confirm it (e.g., loop variable updates, logical condition checks),
  (c) counter-evidence that would refute it (e.g., proper condition checks, updates to loop variables).

Quick red flags in partial code (weak → strong)
- Strong: The loop has a condition that is always true (e.g., `while (true)`) and does not contain any mechanism to break or exit the loop.
- Medium: Loop variables are not updated, making it impossible for the loop to exit.
- Medium: The exit condition of the loop is logically flawed (e.g., conditions that are contradictory or always false).
- Weak: Loop exit conditions may be handled in external functions or systems not visible in the current snippet → treat as Unknown and reduce confidence.
"""
if __name__ == "__main__":
    print(CWE_835_RULE)